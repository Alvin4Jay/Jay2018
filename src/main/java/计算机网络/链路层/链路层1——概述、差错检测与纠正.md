#链路层概述、差错检测与纠正技术

​	在链路层中，存在两种截然不同的链路层信道。第一种类型是**广播信道**，用于连接有线局域网、卫星网和混合光纤同轴电缆接入网中多台主机。由于多台主机与相同的广播信道连接，需要**媒体访问协议**来协调帧的传输。第二种类型的链路层信道是**点对点通信链路**，协调对点对点链路的访问使用<u>**点对点协议**</u>。

## 一、链路层概述

​	运行链路层协议的任何设备称之为**结点**，包括主机、路由器、交换机和WiFi接入点。沿着通信路径连接相邻结点的通信信道称为**链路**。为了将一个数据报从源主机传输到目的主机，数据报必须通过沿端到端路径上的各段链路传输。在通过特定的链路时，传输结点将数据报封装在**链路层帧**中，并将该帧传送到链路中。

### 1.链路层提供的服务

​	链路层协议能提供的可能服务包括：

- **成帧**：在每个网络层数据报经链路传送之前，所有的链路层协议都要将其用链路层帧封装起来。一个帧由一个数据字段和若干首部字段组成，其中网络层数据报插在数据字段中。帧的结构由链路层协议规定。
- **链路接入**：媒体访问控制协议(MAC)规定了帧在链路上传输的规则，用于协调多个结点的帧传输。
- **可靠交付**：当链路层协议提供可靠交付服务时，它保证无差错的经链路层移动每一个网路层数据报。通常通过确认和重传实现，用于易于产生高差错率的链路如无线链路，其目的是本地纠正一个差错，而不是通过运输层或应用层协议迫使进行端到端的数据重传。
- **差错检测和纠正**

### 2.链路层的实现

​	在**路由器**中，链路层实现在其**线路卡**中。下面简述**主机上的链路层实现**。

![](http://pbku1z6p0.bkt.clouddn.com/5-1.png?imageMogr2/auto-orient/thumbnail/x300/blur/1x0/quality/75|imageslim)

​							     网络适配器：它与其他主机组件及协议栈功能的关系 

​	上图显示了典型的**主机体系结构**。链路层的主体部分是在**网络适配器**中实现的，网络适配器也称为**网络接口卡（NIC）**。位于网络适配器核心的是链路层控制器，该控制器是一个实现了许多链路层服务(成帧、链路接入、差错检测等)的专用芯片。所以**链路层控制器的很多功能是用硬件实现**的。

​	此外，部分链路层功能是在运行于主机CPU上的软件中实现的。链路层的软件组件实现了高层链路层功能，如组装链路层寻址信息和激活控制器硬件。在接收端，链路层软件响应控制器中断，处理差错条件和将数据报向上传递至网络层。所以，**链路层是软件和硬件的综合体，此处是协议栈中软件和硬件交接的地方。**

## 二、差错检测和纠正技术

​	指**对从一个结点发送到另一个物理上连接的邻近结点的链路层帧中的比特损伤进行检测和纠正**。

![](http://pbku1z6p0.bkt.clouddn.com/5-2.png?imageMogr2/auto-orient/thumbnail/x300/blur/1x0/quality/75|imageslim)

​											          差错检测与纠正的场景

​	上图显示了我们研究的环境。在发送节点，为了保护比特免受差错，使用**差错检测与纠正比特(EDC)**来增强数据D。通常，要保护的数据不仅包含从网络层传递下来需要通过链路传输的数据报，而且包括链路帧首部中的链路级的寻址信息、序号和其他字段。链路级帧中的D和EDC都被发送至接受节点。在接受节点，接收到比特序列D1和EDC1。因传输中的比特翻转，D1和EDC1可能与初始的D和EDC不同。

​	接收方需要在只收到D1和EDC1的情况下，确定D1是否和初始的D相同，即是否出现了差错。**差错检测手段主要有三种：奇偶校验（用来描述差错检测和纠正背后隐含的基本思想）、检验和方法（应用于运输层）和循环冗余校验（应用于网络适配器中的链路层）。**

###1.奇偶校验

​	如果使用**单个奇偶检验位**进行差错检测，未检测出差错的概率很大。一般化方案是**单比特奇偶校验方案的二维一般化**，这种方案下接收方能识别发生差错的比特并**纠正**它。 接收方检测和纠正差错的能力称为**前向纠错(FEC)**。

### 2.检验和方法

​	检验和方法需要相对小的分组开销，在TCP和UDP中的检验和使用了16比特。与循环冗余检测CRC相比，他们提供了相对弱的差错保护。

### 3.循环冗余检测

​	循环冗余检测技术广泛应用于计算机网络中，循环冗余检测(编码)也称为**多项式编码**。具体操作见P295-296。

